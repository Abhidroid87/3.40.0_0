import{a as h,c as P,r as m,j as e,T as z,X as E,C as T,F as S,A as L,m as p,b as $,R as D}from"./globals.BOLoAqbZ.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=h("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=h("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=h("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=h("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=h("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=h("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=h("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);async function K(s,o){return{text:(o?`AI placeholder response.
Context provided: ${o.slice(0,140)}...
Question: ${s.slice(0,140)}...`:`AI placeholder response. Question: ${s.slice(0,160)}...`)+`

(Real AI will be wired post-hackathon)`,tokens:0}}async function W(s){const o=s?s.slice(0,200):"";return{text:`Summary placeholder: This page appears to contain textual content.

Key points (mock):
- Extracted ${(s==null?void 0:s.length)||0} characters
- Preview: "${o}"
- Real summarization will use Chrome AI APIs later.`,tokens:0}}const _=P((s,o)=>({currentSummary:null,chatMessages:[],isLoading:!1,error:null,setError:t=>s({error:t}),setSummary:t=>s({currentSummary:t}),clearChat:()=>s({chatMessages:[]}),summarizePage:async()=>{s({isLoading:!0,error:null});try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!(t!=null&&t.id))throw new Error("No active tab found. Please try again on a different page.");const n=t.url||"";if(n.startsWith("chrome://")||n.startsWith("chrome-extension://")||n.startsWith("edge://"))throw new Error("Cannot analyze browser system pages. Please try on a regular webpage.");try{await chrome.scripting.executeScript({target:{tabId:t.id},func:()=>{window.hasOwnProperty("__manageExtensionInitialized")||(console.log("[Content Script] Initializing via dynamic injection..."),window.__manageExtensionInitialized=!0)}})}catch(i){console.warn("Could not inject content script checker:",i)}const r=await Promise.race([chrome.tabs.sendMessage(t.id,{action:"getPageContent"}),new Promise((i,l)=>setTimeout(()=>l(new Error("Content script not responding. Please refresh the page.")),5e3))]);if(r!=null&&r.content){const i=await W(r.content);s({currentSummary:i.text})}else s({currentSummary:"No content available to summarize on this page."})}catch(t){const n=t instanceof Error?t.message:"An unknown error occurred";console.error("Failed to summarize page:",n),s({currentSummary:"Failed to analyze page content.",error:n})}finally{s({isLoading:!1})}},sendChatMessage:async t=>{const n={role:"user",content:t,timestamp:Date.now()};s(r=>({chatMessages:[...r.chatMessages,n],isLoading:!0,error:null}));try{const i={role:"assistant",content:(await K(t,o().currentSummary||void 0)).text,timestamp:Date.now()};s(l=>({chatMessages:[...l.chatMessages,i],isLoading:!1,error:null}))}catch(r){const i=r instanceof Error?r.message:"An unknown error occurred";console.error("Chat error:",i),s({error:i,isLoading:!1})}}}));async function O(){return"unavailable"}function G(){const[s,o]=m.useState({context:"unknown",aiAvailable:!1,modelStatus:"checking"});m.useEffect(()=>{t()},[]);const t=async()=>{try{const r=window.location.href.includes("sidepanel.html")?"Side Panel":window.location.href.includes("newtab.html")?"New Tab":"Unknown Context",i=!!(window.ai&&window.ai.languageModel),l=await O();o({context:r,aiAvailable:i,modelStatus:l})}catch(r){o(i=>({...i,error:r instanceof Error?r.message:"Unknown error occurred"}))}},n=r=>{switch(r){case"ready":return"text-green-600";case"downloadable":return"text-yellow-600";case"unavailable":return"text-red-600";case"context-error":return"text-orange-600";default:return"text-gray-600"}};return e.jsxs("div",{className:"p-4 bg-white/80 backdrop-blur-sm rounded-lg border border-gray-200/50",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800",children:"AI Diagnostics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Current Context:"}),e.jsx("p",{className:"text-base text-gray-800",children:s.context})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"AI API Available:"}),e.jsx("p",{className:`text-base ${s.aiAvailable?"text-green-600":"text-red-600"}`,children:s.aiAvailable?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Model Status:"}),e.jsx("p",{className:`text-base ${n(s.modelStatus)}`,children:s.modelStatus})]}),s.error&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded",children:e.jsx("p",{className:"text-sm text-red-600",children:s.error})}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 transition-colors",children:"Run Diagnostics Again"})}),s.modelStatus!=="ready"&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["To enable AI features:",e.jsxs("ol",{className:"list-decimal ml-4 mt-2 space-y-1",children:[e.jsx("li",{children:"Open chrome://flags in a new tab"}),e.jsx("li",{children:'Enable "Prompt API for Gemini Nano"'}),e.jsx("li",{children:'Enable "Optimization Guide On-Device Model"'}),e.jsx("li",{children:"Restart Chrome"}),e.jsx("li",{children:'Right-click extension icon and select "Show in Side Panel"'})]})]})})]})]})}const H=()=>{const[s,o]=m.useState(""),[t,n]=m.useState(null),[r,i]=m.useState([]),[l,y]=m.useState(""),[c,u]=m.useState(!1);m.useEffect(()=>{chrome.tabs.query({active:!0,currentWindow:!0},a=>{var x;(x=a[0])!=null&&x.url&&(o(a[0].url),f(a[0].url))}),w()},[]);const f=async a=>{const k=(await chrome.storage.local.get("notes")).notes||{};n(k[a]||{id:crypto.randomUUID(),title:"",content:"",url:a,tags:[],lastModified:new Date})},w=async()=>{const a=await chrome.storage.local.get("tasks");i(a.tasks||[])},d=async()=>{if(t){u(!0);try{const x=(await chrome.storage.local.get("notes")).notes||{};if(x[s]={...t,lastModified:new Date},await chrome.storage.local.set({notes:x}),t.taskId){const g=(await chrome.storage.local.get("tasks")).tasks||[],b=g.findIndex(I=>I.id===t.taskId);b!==-1&&(g[b].notes=g[b].notes||[],g[b].notes.includes(t.id)||(g[b].notes.push(t.id),await chrome.storage.local.set({tasks:g})))}}catch(a){console.error("Failed to save note:",a)}finally{u(!1)}}},j=()=>{!t||!l.trim()||(t.tags.includes(l.trim())||n({...t,tags:[...t.tags,l.trim()]}),y(""))},A=a=>{t&&n({...t,tags:t.tags.filter(x=>x!==a)})},M=a=>{t&&n({...t,taskId:a===t.taskId?void 0:a})};return t?e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("input",{type:"text",value:t.title,onChange:a=>n({...t,title:a.target.value}),placeholder:"Note title...",className:"w-full px-3 py-2 bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("textarea",{value:t.content,onChange:a=>n({...t,content:a.target.value}),placeholder:"Start taking notes...",className:"w-full h-40 px-3 py-2 bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate",children:s})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map(a=>e.jsxs("div",{className:"flex items-center space-x-1 bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm",children:[e.jsx(z,{className:"w-3 h-3"}),e.jsx("span",{children:a}),e.jsx("button",{onClick:()=>A(a),className:"hover:text-red-600",children:e.jsx(E,{className:"w-3 h-3"})})]},a))}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:l,onChange:a=>y(a.target.value),onKeyPress:a=>a.key==="Enter"&&j(),placeholder:"Add a tag...",className:"flex-1 px-3 py-1 bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:j,disabled:!l.trim(),className:"px-3 py-1 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 disabled:opacity-50",children:"Add"})]})]}),r.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Attach to Task"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:r.map(a=>e.jsxs("button",{onClick:()=>M(a.id),className:`flex items-center justify-between p-2 rounded-lg text-sm ${t.taskId===a.id?"bg-blue-600 text-white":"bg-white/80 backdrop-blur-sm border border-gray-200/50 text-gray-800 hover:border-blue-500"}`,children:[e.jsx("span",{className:"truncate",children:a.title}),t.taskId===a.id&&e.jsx(T,{className:"w-4 h-4 ml-2"})]},a.id))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:d,disabled:c,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(U,{className:"w-4 h-4"}),e.jsx("span",{children:c?"Saving...":"Save Note"})]})})]}):null};function Q(){const{currentSummary:s,chatMessages:o,isLoading:t,summarizePage:n,sendChatMessage:r,clearChat:i}=_(),[l,y]=m.useState(""),[c,u]=m.useState("summary");m.useEffect(()=>{c==="summary"&&n()},[n,c]);const f=async()=>{l.trim()&&(await r(l),y(""))},w=d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),f())};return e.jsxs("div",{className:"h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex flex-col",children:[e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border-b border-gray-200/50 p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(N,{className:"w-5 h-5 text-blue-600"}),e.jsx("h1",{className:"font-semibold text-gray-800",children:"Manage Assistant"})]}),e.jsxs("div",{className:"flex space-x-1 bg-gray-100 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>u("summary"),className:`flex-1 flex items-center justify-center space-x-2 py-2 px-3 rounded-md text-sm font-medium transition-colors ${c==="summary"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:"Summary"})]}),e.jsxs("button",{onClick:()=>u("chat"),className:`flex-1 flex items-center justify-center space-x-2 py-2 px-3 rounded-md text-sm font-medium transition-colors ${c==="chat"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(C,{className:"w-4 h-4"}),e.jsx("span",{children:"Chat"})]}),e.jsxs("button",{onClick:()=>u("notes"),className:`flex-1 flex items-center justify-center space-x-2 py-2 px-3 rounded-md text-sm font-medium transition-colors ${c==="notes"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:"Notes"})]}),e.jsxs("button",{onClick:()=>u("diagnostics"),className:`flex-1 flex items-center justify-center space-x-2 py-2 px-3 rounded-md text-sm font-medium transition-colors ${c==="diagnostics"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:"Status"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(L,{mode:"wait",children:[c==="summary"&&e.jsx(p.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"h-full p-4 overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Page Summary"}),e.jsxs("button",{onClick:n,disabled:t,className:"px-3 py-1 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 disabled:opacity-50 flex items-center space-x-1",children:[t?e.jsx(v,{className:"w-4 h-4 animate-spin"}):e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:"Refresh"})]})]}),t?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Analyzing page content..."})]})}):s?e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-4 border border-gray-200/50",children:e.jsx("p",{className:"text-gray-700 leading-relaxed",children:s})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(S,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No content to summarize"}),e.jsx("p",{className:"text-sm",children:"Navigate to a page with text content"})]})]})},"summary"),c==="notes"&&e.jsx(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full overflow-y-auto",children:e.jsx(H,{})},"notes"),c==="diagnostics"&&e.jsx(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full p-4 overflow-y-auto",children:e.jsx(G,{})},"diagnostics"),c==="chat"&&e.jsxs(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[o.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(C,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Start a conversation"}),e.jsx("p",{className:"text-sm",children:"Ask questions about the current page"})]}):o.map((d,j)=>e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${d.role==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] p-3 rounded-lg ${d.role==="user"?"bg-blue-600 text-white":"bg-white/80 backdrop-blur-sm border border-gray-200/50 text-gray-800"}`,children:e.jsx("p",{className:"text-sm",children:d.content})})},j)),t&&e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex justify-start",children:e.jsx("div",{className:"bg-white/80 backdrop-blur-sm border border-gray-200/50 p-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"w-4 h-4 animate-spin text-blue-600"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Thinking..."})]})})})]}),e.jsxs("div",{className:"p-4 bg-white/80 backdrop-blur-sm border-t border-gray-200/50",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:l,onChange:d=>y(d.target.value),onKeyPress:w,placeholder:"Ask about this page...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:t}),e.jsx("button",{onClick:f,disabled:t||!l.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(F,{className:"w-4 h-4"})})]}),o.length>0&&e.jsx("button",{onClick:i,className:"mt-2 text-xs text-gray-500 hover:text-gray-700",children:"Clear conversation"})]})]},"chat")]})})]})}$.createRoot(document.getElementById("root")).render(e.jsx(D.StrictMode,{children:e.jsx(Q,{})}));
